{{def render_content(box=box):}}
{{if box['content_type'] == '':}}
	<!-- This box is empty -->
{{elif box['content_type'] == 'box':}}
	{{childbox = extra_box_info[box['id']]['child_box']}}
	<div class="clipbox" id="box{{box['id']}}">
		{{ render_content(childbox) }}
	</div>
{{elif box['content_type'] == 'text/html':}}
	<div class="textbox">{{=extra_box_info[box['id']]['file_contents']}}</div>
{{elif box['content_type'] in ['image/jpeg', 'image/svg+xml']:}}
	<img src="{{=extra_box_info[box['id']]['file_url']}}" style="width: 100%; height: 100%" />
{{elif box['content_type'] in ['application/pdf']:}}
    <!-- See http://jsbin.com/pdfjs-helloworld-v2/1/edit -->
    <canvas id="canvas_box{{=box['id']}}" style="border: 1px black dotted; width:100%; height: 100%"></canvas>
    <script type="text/javascript">
        var url = "{{=box_info['file_url']}}";
        PDFJS.disableWorker = true;
        PDFJS.getDocument(url).then(function getPdfHelloWorld(pdf) {

                                pdf.getPage(1).then(function getPageHelloWorld(page) {
                                                    var scale = 1.5;
                                                    var viewport = page.getViewport(scale);

                                                    var canvas = document.getElementById('canvas_box{{=box["id"]}}');
                                                    var context = canvas.getContext('2d');
                                                    canvas.height = viewport.height;
                                                    canvas.width = viewport.width;

                                                    page.render({canvasContext: context, viewport: viewport});
                                                    });
                                });
    </script>
{{else:}}<!-- Content type not supported: {{=box['content_type']}} -->{{pass}}
{{return}}
{{render_content(box)}}